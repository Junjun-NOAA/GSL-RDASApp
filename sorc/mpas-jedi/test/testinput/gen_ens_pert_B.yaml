test:
  float relative tolerance: 0.005
  integer tolerance: 0
  reference filename: testoutput/gen_ens_pert_B.ref
  log output filename: testoutput/gen_ens_pert_B.run
  test output filename: testoutput/gen_ens_pert_B.run.ref
  
forecast length: PT1H

include control: true

geometry:
  nml_file: "./Data/480km/namelist.atmosphere_2018041500"
  streams_file: "./Data/480km/streams.atmosphere"

initial condition:
  state variables: &vars
  - air_temperature
  - water_vapor_mixing_ratio_wrt_moist_air
  - eastward_wind
  - northward_wind
  - air_pressure_at_surface
  filename: "./Data/480km/bg/restart.2018-04-15_00.00.00.nc"
  date: '2018-04-15T00:00:00Z'
  
members: 4

background error:
  covariance model: SABER
  saber central block:
    saber block name: BUMP_NICAS
    read:
      io:
        files prefix: Data/bump/mpas_parametersbump_cov
      drivers:
        multivariate strategy: univariate
        read local nicas: true
      grids:
      - model:
          variables:
          - air_temperature
          - water_vapor_mixing_ratio_wrt_moist_air
          - eastward_wind
          - northward_wind
      - model:
          variables:
          - air_pressure_at_surface
  saber outer blocks:
  - saber block name: StdDev
    read:
      model file:
        filename: Data/bump/mpas.stddev.$Y-$M-$D_$h.$m.$s.nc
        date: '2018-04-15T00:00:00Z'
        stream name: control
        
model:
  name: MPAS
  tstep: PT30M
  model variables:
  - water_vapor_mixing_ratio_wrt_moist_air
  - air_pressure_at_surface
  - air_temperature
  - eastward_wind
  - northward_wind
  
output:
  type: ens
  first: PT0H
  frequency: PT1H
  filename: Data/enkf/model/EnsPertB.$Y-$M-$D_$h.$m.$s.nc.%member%
  member pattern: '%member%'

perturbed variables:
- water_vapor_mixing_ratio_wrt_moist_air
- air_pressure_at_surface
- air_temperature
- eastward_wind
- northward_wind
