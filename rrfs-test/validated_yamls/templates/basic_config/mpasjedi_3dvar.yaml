_member: &memberConfig
  date: &analysisDate '2024-05-27T00:00:00Z'
  state variables: &incvars [water_vapor_mixing_ratio_wrt_moist_air, air_pressure_at_surface, air_temperature, northward_wind, eastward_wind]
  stream name: ensemble

output:
  filename: ./ana.$Y-$M-$D_$h.$m.$s.nc
  stream name: analysis
variational:
  minimizer:
    algorithm: DRPCG
  iterations:
  - geometry:
      nml_file: ./namelist.atmosphere
      streams_file: ./streams.atmosphere
      deallocate non-da fields: true
      interpolation type: unstructured
    gradient norm reduction: 1e-3
    ninner: 50
  - geometry:
      nml_file: ./namelist.atmosphere
      streams_file: ./streams.atmosphere
      deallocate non-da fields: true
      interpolation type: unstructured
    gradient norm reduction: 1e-3
    ninner: 50
cost function:
  cost type: 3D-Var
  time window:
     begin: '2024-05-26T21:00:00Z'
     length: PT6H
  jb evaluation: false
  geometry:
    nml_file: ./namelist.atmosphere
    streams_file: ./streams.atmosphere
    deallocate non-da fields: true
    interpolation type: unstructured
  analysis variables: *incvars
  background:
    state variables:
    - water_vapor_mixing_ratio_wrt_moist_air
    - air_pressure_at_surface
    - air_temperature
    - northward_wind
    - eastward_wind
    - air_potential_temperature
    - dry_air_density
    - u
    - water_vapor_mixing_ratio_wrt_dry_air
    - air_pressure
    - landmask
    - seaice_fraction
    - snowc
    - skin_temperature_at_surface
    - ivgtyp
    - isltyp
    - snowh
    - vegetation_area_fraction
    - eastward_wind_at_10m
    - northward_wind_at_10m
    - lai
    - smois
    - tslb
    - pressure_p
    - cloud_liquid_water
    - cloud_liquid_ice
    - graupel
    - rain_water
    - snow_water
    - cldfrac
    filename: data/mpasout.2024-05-27_00.00.00.nc
    date: *analysisDate
#  Use this block for Identity B
#  background error:
#    covariance model: SABER
#    saber central block:
#      saber block name: ID
  background error:
    covariance model: SABER
    saber central block:
      saber block name: BUMP_NICAS
      active variables: *incvars
      read:
        io:
          data directory: data/bumploc/conus12km-401km11levels
          files prefix: bumploc_401km11levels
        drivers:
          multivariate strategy: duplicated
          read local nicas: true
        model:
          level for 2d variables: last

  observations:
     observers:
        "@OBSERVATIONS@"
