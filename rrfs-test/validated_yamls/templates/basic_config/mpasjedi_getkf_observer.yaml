_member: &memberConfig
  date: &analysisDate '2024-05-27T00:00:00Z'
  state variables:
  - water_vapor_mixing_ratio_wrt_moist_air
  - air_pressure_at_surface
  - air_temperature
  - northward_wind
  - eastward_wind
  - air_potential_temperature
  - dry_air_density
  - u
  - water_vapor_mixing_ratio_wrt_dry_air
  - air_pressure
  - landmask
  - seaice_fraction
  - snowc
  - skin_temperature_at_surface
  - ivgtyp
  - isltyp
  - snowh
  - vegetation_area_fraction
  - eastward_wind_at_10m
  - northward_wind_at_10m
  - lai
  - smois
  - tslb
  - pressure_p
  - cloud_liquid_water
  - cloud_liquid_ice
  - graupel
  - rain_water
  - snow_water
  - cldfrac
  stream name: background

increment variables: [air_temperature, water_vapor_mixing_ratio_wrt_moist_air, eastward_wind, northward_wind, air_pressure_at_surface]

output mean prior:
  filename: ./bkg.$Y-$M-$D_$h.$m.$s.nc
  stream name: background

output: # for outputting mean posterior
  filename: ./ana.$Y-$M-$D_$h.$m.$s.nc
  stream name: analysis

time window:
  begin: '2024-05-26T21:00:00Z'
  length: PT6H

geometry:
  nml_file: ./namelist.atmosphere
  streams_file: ./streams.atmosphere
  deallocate non-da fields: true
  interpolation type: unstructured
  iterator dimension: 2

background: 
  members from template:
    template:
      <<: *memberConfig
      filename: ./data/ens/mem%iMember%/mpasout.2024-05-27_00.00.00.nc
    pattern: "%iMember%"
    start: 1
    zero padding: 3
    nmembers: 30

driver:
  run as observer only: true
  update obs config with geometry info: false

local ensemble DA:
  solver: GETKF
  use linear observer: true
  vertical localization: # current settings use 12 modulated members
    fraction of retained variance: 0.850
    lengthscale: 0.50
    lengthscale units: logp
  inflation:
    rtps: 0.95
    rtpp: 0.6
    mult: 1.1

observations:
     observers:
        "@OBSERVATIONS@"

test:
  reference filename: testoutput/rrfs-mpasjedi-getkf-observer.ref
  test output filename: ./rrfs-mpasjedi-getkf-observer.out
  float relative tolerance: 1.0e-2
  float absolute tolerance: 1.0e-6
  integer tolerance: 3
